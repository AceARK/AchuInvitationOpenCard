<!DOCTYPE html>
<html>
<head>
	<title>Marriage Invitation</title>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Playball">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Tangerine">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Niconne">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IM+Fell+Double+Pica:ital@1">
	<link rel="stylesheet" type="text/css" href="assets/css/reset.css">
	<link rel="stylesheet" type="text/css" href="assets/css/style_new_ganesh.css">
	<script src="https://kit.fontawesome.com/6faeff70cb.js" crossorigin="anonymous"></script>
</head>
<body>
	<div id="instructions">
		<p>Click card to open</p>
		<p>Click outside to close</p>
	</div>
	<div id="overlayClicker"></div>	
	<div id="clickMe">
		<span><i class="fas fa-hand-pointer fa-2x"></i></span>
	</div>
    <div class="card">
		<div id="content">
			<div class='separate'>
				<p id="who">K.E. Sujatha and K.T. Radhakrishnan</p>
				<p>'Aishwarya', Elayavoor, Kannur</p>
			</div>
			<div class='separate' id="what">
				<p>request your prayers and blessings</p>
				<p>on the occasion of the marriage of their daughter</p>
			</div>
			<div class='separate'>
				<p id="bride">Ashwathi</p>
				<p>(Granddaughter of late Smt. K. E. Nalini Amma & late Sri C. Bhaskaran Nambiar</p>
				<p>late Smt. K. T. Chandravalli Amma & late Sri C. Balakrishnan Nambiar</p>
			</div>
			<div class="with">with</div>
			<div class='separate'>
				<p id="groom">Gautham</p>
				<p>(Son of Smt. M. P. Shylaja & Sri M. P. Pavithran,</p>
				<p>Grandson of Smt. M. P. Rohini Amma & late Sri K. K. Damodaran Nambiar</p>
				<p>late Smt. M. P. Lakshmikutti Amma & late Sri C. Kelappan Nambiar</p>
			</div>
			<div class='separate'>
				<p id="when">On Sunday, <span class="numberFont">3</span>rd January <span class="numberFont">2021</span></p>
				<p id="where">at Sadhoo Kalyana Mandapam, Thana, Kannur</p>
			</div>
			<div class='separate'>
				<p id="muhurtham">Muhurtham : <span class="numberFont">11:30</span> am to <span class="numberFont">12:00</span> noon</p>
			</div>
			<div class='separate' id="details">
				<p>Ph : <span class="numberFont">0497-2729746</span>, Mob : <span class="numberFont">94004 29746</span>, <span class="numberFont">94953 89839</span></p>
			</div>
			<div class='separate' id="compliments">
				<p>With best compliments : Akhila and Vijesh</p>
			</div>
		</div>
	</div>
	<audio id="backgroundMusic">
		<source src="assets/audio/bgm_main.mp3" type="audio/mpeg">
	</audio>
	<audio id="backgroundMusicMobile">
		<source src="assets/audio/bgm_main.mp3" type="audio/mpeg">
	</audio>
</body>
<script>
	let audioPlaying = false;
	document.addEventListener("DOMContentLoaded", () => {
		if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
			document.querySelector('.card').addEventListener('click', playMusic);
		} 
		document.getElementById('overlayClicker').addEventListener('click', playMusic);
	});
	function getSoundAndFadeAudio (audiosnippetId) {
		var sound = document.getElementById(audiosnippetId);
		// Set the point in playback that fadeout begins. This is for a 2 second fade out.
		var fadePoint = sound.duration - 10; 
		var fadeAudio = setInterval(function () {
			// Only fade if past the fade out point or not at zero already
			if ((sound.currentTime >= fadePoint) && (sound.volume != 0.0)) {
				sound.volume -= 0.1;
			}
			// When volume at zero stop all the intervalling
			if (sound.volume === 0.0) {
				clearInterval(fadeAudio);
			}
		}, 200);
	}
	function playMusic() {
		if(!audioPlaying) {
			console.log("Trying to play now");
			audioPlaying = true;
			if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
				document.getElementById('clickMe').style.display = 'none';
				if(document.getElementById('overlayClicker').style.display !== 'none') {
					document.getElementById('overlayClicker').style.display = 'none';
					console.log("Gonna try clicking thru js now");
					document.querySelector('.card').click();
					document.getElementById('backgroundMusicMobile').play();
					getSoundAndFadeAudio('backgroundMusicMobile');
					document.getElementById('content').style.visibility = 'visible';
				} else {
					document.getElementById('backgroundMusicMobile').play();
					getSoundAndFadeAudio('backgroundMusicMobile');
					document.getElementById('content').style.visibility = 'visible';
				}
			}else{
				document.getElementById('backgroundMusic').play();
				getSoundAndFadeAudio('backgroundMusic');
				document.getElementById('overlayClicker').style.display = 'none';
				document.getElementById('content').style.visibility = 'visible';
			}
		} else {
			console.log("Deregistering event.");
			document.getElementById('overlayClicker').removeEventListener('click', playMusic);
			document.querySelector('.card').removeEventListener('click', playMusic);
		}
	}	
</script>
</html>